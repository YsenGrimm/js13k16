!function(t){function i(e){if(s[e])return s[e].exports;var h=s[e]={exports:{},id:e,loaded:!1};return t[e].call(h.exports,h,h.exports,i),h.loaded=!0,h.exports}var s={};return i.m=t,i.c=s,i.p="",i(0)}([function(t,i,s){"use strict";var e=s(1);new e.Game},function(t,i,s){"use strict";var e=s(2),h=s(5),a=s(6),r=s(3),n=s(4),l=s(7),o=s(8),c=function(){function t(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.ctx.translate(.5,.5),this.w=800,this.h=480,this.bgColor="#533B59",this.collisionOffset=5,this.layer=6,this.cells=16,this.scanline=new a.Scanline(this.ctx,this.w,this.h),this.activeWave=0,this.player=new e.Player(0,this.ctx,this.layer,0,this.w,this.h,o.PATTERN.waves[this.activeWave].win),this.enemies=new Array;for(var t=0,i=o.PATTERN.waves[this.activeWave].enemys;t<i.length;t++){var s=i[t];this.enemies.push(new h.Enemy(s.id,this.ctx,this.w,this.h,s.ring,s.angle,s.speed,s.delay))}this.gems=new Array;for(var r=0,c=o.PATTERN.waves[this.activeWave].gems;r<c.length;r++){var d=c[r];this.gems.push(new n.Gem(d.id,this.ctx,this.w,this.h,d.type,d.ring,d.angle,d.speed,d.delay))}this.stats=new l.Stats(this.ctx,this.player,{x:0,y:0,width:this.w,height:this.h}),this.update=this.update.bind(this),window.requestAnimationFrame(this.update)}return t.prototype.update=function(){var t=this;this.scanline.update();for(var i=0;i<this.enemies.length;i++)this.enemies[i].update(),Math.abs(this.enemies[i].realPos-this.scanline.scanlinePos)<2&&(this.enemies[i].alpha=1);for(var i=0;i<this.gems.length;i++)this.gems[i].update(),Math.abs(this.gems[i].realPos-this.scanline.scanlinePos)<2&&(this.gems[i].alpha=1);this.player.update(),this.player.checkGoals()&&this.advanceWave();for(var s=function(i){e.player.pos===e.enemies[i].layer&&Math.abs(e.player.axisPool[e.player.axis]-e.enemies[i].angle)<e.collisionOffset&&(e.player.health--,e.enemies=e.enemies.filter(function(s){return s!==t.enemies[i]}))},e=this,h=0;h<this.enemies.length;h++)s(h);for(var a=function(i){r.player.pos===r.gems[i].layer&&Math.abs(r.player.axisPool[r.player.axis]-r.gems[i].angle)<r.collisionOffset&&(r.player.collectGem(r.gems[i].type),r.gems=r.gems.filter(function(s){return s!==t.gems[i]}))},r=this,h=0;h<this.gems.length;h++)a(h);this.player.health<0&&this.resetWave(),this.draw(),window.requestAnimationFrame(this.update)},t.prototype.draw=function(){this.ctx.fillStyle=this.bgColor,this.ctx.fillRect(0,0,this.w,this.h),this.drawBoard(),this.scanline.render();for(var t=0;t<this.enemies.length;t++)this.enemies[t].render();for(var t=0;t<this.gems.length;t++)this.gems[t].render();this.player.render(),this.stats.render(),this.ctx.font="13px sans-serif",this.ctx.fillStyle="rgb(199, 191, 65)",this.ctx.fillText(this.player.green.toString()+" | "+this.player.greenGoal.toString(),30,40),this.ctx.fillStyle="rgb(0, 90, 127)",this.ctx.fillText(this.player.blue.toString()+" | "+this.player.blueGoal.toString(),30,60),this.ctx.fillStyle="rgb(255, 199, 54)",this.ctx.fillText(this.player.yellow.toString()+" | "+this.player.yellowGoal.toString(),30,80)},t.prototype.drawBoard=function(){this.ctx.strokeStyle="#D95970";for(var t=50,i=30,s=0;s<this.layer+1;s++)this.ctx.beginPath(),this.ctx.arc(this.w/2,this.h/2,t+i*s,0,2*Math.PI),this.ctx.stroke();this.drawDebugLines(),this.ctx.fillStyle="#D95970",this.ctx.beginPath(),this.ctx.arc(this.w/2,this.h/2,t,0,2*Math.PI),this.ctx.fill()},t.prototype.drawDebugLines=function(){this.ctx.strokeStyle="#D95970";for(var t=360/this.cells,i=0;i<this.cells;i++)this.ctx.beginPath(),this.ctx.moveTo(this.w/2,this.h/2),this.ctx.lineTo(230*Math.cos(r.Utils.deg2rad(i*t))+this.w/2,230*Math.sin(r.Utils.deg2rad(i*t))+this.h/2),this.ctx.stroke()},t.prototype.resetWave=function(){this.player.reset()},t.prototype.advanceWave=function(){this.player.reset(),this.activeWave++,this.player.setGoals(o.PATTERN.waves[this.activeWave].win);for(var t=0,i=o.PATTERN.waves[this.activeWave].enemys;t<i.length;t++){var s=i[t];this.enemies.push(new h.Enemy(s.id,this.ctx,this.w,this.h,s.ring,s.angle,s.speed,s.delay))}for(var e=0,a=o.PATTERN.waves[this.activeWave].gems;e<a.length;e++){var r=a[e];this.gems.push(new n.Gem(r.id,this.ctx,this.w,this.h,r.type,r.ring,r.angle,r.speed,r.delay))}},t}();i.Game=c},function(t,i,s){"use strict";var e=s(3),h=s(4),a=function(){function t(t,i,s,e,h,a,r){var n=this;this.id=t,this.ctx=i,this.color="rgb(242, 214, 128)",this.pos=0,this.axis=e,this.axisPool=[0,90,180,270],this.maxPos=s-1,this.minOffset=64,this.offset=30,this.gameWidth=h,this.gameHeigth=a,this.size=6,this.width=30,this.height=4,this.maxHealth=3,this.health=this.maxHealth,this.green=0,this.greenGoal=r.green,this.blue=0,this.blueGoal=r.blue,this.yellow=0,this.yellowGoal=r.yellow,document.addEventListener("keydown",function(t){return n.handleInput(t)})}return t.prototype.handleInput=function(t){switch(this.id){case 0:"ArrowLeft"===t.key&&(this.pos--,this.pos<0&&(this.pos=0)),"ArrowRight"===t.key&&(this.pos++,this.pos>this.maxPos&&(this.pos=this.maxPos)),"ArrowUp"===t.key&&(this.axis--,this.axis<0&&(this.axis=3)),"ArrowDown"===t.key&&(this.axis++,this.axis>3&&(this.axis=0));break;case 1:"a"===t.key&&(this.pos--,this.pos<0&&(this.pos=0)),"d"===t.key&&(this.pos++,this.pos>this.maxPos&&(this.pos=this.maxPos)),"w"===t.key&&(this.axis--,this.axis<0&&(this.axis=3)),"s"===t.key&&(this.axis++,this.axis>3&&(this.axis=0))}},t.prototype.update=function(){},t.prototype.render=function(){this.ctx.fillStyle=this.color,Math.abs(Math.cos(e.Utils.deg2rad(this.axisPool[this.axis])))>.5?this.ctx.fillRect(Math.cos(e.Utils.deg2rad(this.axisPool[this.axis]))*(1+this.minOffset+this.offset*this.pos)+this.gameWidth/2-this.width/2,Math.sin(e.Utils.deg2rad(this.axisPool[this.axis]))*(this.minOffset+this.offset*this.pos)+this.gameHeigth/2-this.height/2,this.width,this.height):this.ctx.fillRect(Math.cos(e.Utils.deg2rad(this.axisPool[this.axis]))*(1+this.minOffset+this.offset*this.pos)+this.gameWidth/2-this.height/2,Math.sin(e.Utils.deg2rad(this.axisPool[this.axis]))*(this.minOffset+this.offset*this.pos)+this.gameHeigth/2-this.width/2,this.height,this.width)},t.prototype.collectGem=function(t){switch(t){case h.GemType.G:this.green++;break;case h.GemType.B:this.blue++;break;case h.GemType.Y:this.yellow++}},t.prototype.checkGoals=function(){return this.green===this.greenGoal&&this.blue===this.blueGoal&&this.yellow===this.yellowGoal},t.prototype.reset=function(){this.health=this.maxHealth,this.green=0,this.blue=0,this.yellow=0},t.prototype.setGoals=function(t){this.greenGoal=t.green,this.blueGoal=t.blue,this.yellowGoal=t.yellow},t}();i.Player=a},function(t,i){"use strict";var s=function(){function t(){}return t.deg2rad=function(t){return t*(Math.PI/180)},t.getRandomInt=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},t.getRandomArbitrary=function(t,i){return Math.random()*(i-t)+t},t.getRandomColor=function(){return"rgb("+t.getRandomInt(0,255)+", "+t.getRandomInt(0,255)+", "+t.getRandomInt(0,255)+")"},t}();i.Utils=s},function(t,i,s){"use strict";var e=s(3);!function(t){t[t.G=0]="G",t[t.B=1]="B",t[t.Y=2]="Y",t[t.size=3]="size"}(i.GemType||(i.GemType={}));var h=i.GemType,a=function(){function t(t,i,s,e,a,r,n,l,o){switch(this.id=t,this.ctx=i,this.w=s,this.h=e,this.layer=r,this.angle=n,this.minOffset=64,this.offset=30,this.size=14,this.speed=l,this.delay=o,a){case"green":this.type=h.G;break;case"blue":this.type=h.B;break;case"yellow":this.type=h.Y;break;default:this.type=h.G}this.realPos=this.minOffset+this.offset*this.layer,this.alpha=1,this.fade=.006,this.fadeDelay=2*this.speed}return t.prototype.update=function(){return this.delay>0?void(this.delay-=16):(this.angle+=this.speed,this.angle%=360,this.fadeDelay--,void(this.fadeDelay<0&&(this.alpha-=this.fade,this.alpha<0&&(this.alpha=0,this.fadeDelay=5))))},t.prototype.render=function(){if(!(this.delay>0)){switch(this.type){case h.G:this.ctx.fillStyle="rgb(153, 138, 47)";break;case h.B:this.ctx.fillStyle="rgb(0, 60, 85)";break;case h.Y:this.ctx.fillStyle="rgb(255, 166, 68)"}var t=Math.cos(e.Utils.deg2rad(this.angle))*(this.minOffset+this.offset*this.layer)+this.w/2,i=Math.sin(e.Utils.deg2rad(this.angle))*(this.minOffset+this.offset*this.layer)+this.h/2;switch(this.ctx.beginPath(),this.ctx.moveTo(t,i-this.size/2),this.ctx.lineTo(t+this.size/2,i),this.ctx.lineTo(t,i+this.size/2),this.ctx.lineTo(t,i-this.size/2),this.ctx.fill(),this.type){case h.G:this.ctx.fillStyle="rgb(199, 191, 65)";break;case h.B:this.ctx.fillStyle="rgb(0, 90, 127)";break;case h.Y:this.ctx.fillStyle="rgb(255, 199, 54)"}this.ctx.beginPath(),this.ctx.moveTo(t,i+this.size/2),this.ctx.lineTo(t-this.size/2,i),this.ctx.lineTo(t,i-this.size/2),this.ctx.lineTo(t,i+this.size/2),this.ctx.fill()}},t}();i.Gem=a},function(t,i,s){"use strict";var e=s(3),h=function(){function t(t,i,s,e,h,a,r,n){this.id=t,this.ctx=i,this.w=s,this.h=e,this.layer=h,this.angle=a,this.minOffset=64,this.offset=30,this.size=6,this.speed=r,this.delay=n,this.realPos=this.minOffset+this.offset*this.layer,this.alpha=1,this.fade=.006,this.fadeDelay=2*this.speed}return t.prototype.update=function(){return this.delay>0?void(this.delay-=16):(this.angle+=this.speed,this.angle%=360,this.fadeDelay--,void(this.fadeDelay<0&&(this.alpha-=this.fade,this.alpha<0&&(this.alpha=0,this.fadeDelay=5))))},t.prototype.render=function(){this.delay>0||(this.ctx.fillStyle="rgba(217, 91, 91, "+this.alpha+")",this.ctx.beginPath(),this.ctx.arc(Math.cos(e.Utils.deg2rad(this.angle))*(this.minOffset+this.offset*this.layer)+this.w/2,Math.sin(e.Utils.deg2rad(this.angle))*(this.minOffset+this.offset*this.layer)+this.h/2,this.size,0,2*Math.PI),this.ctx.fill())},t}();i.Enemy=h},function(t,i){"use strict";var s=function(){function t(t,i,s){this.ctx=t,this.scanlineStart=30,this.scanlineEnd=240,this.scanlinePos=this.scanlineStart,this.scanlineSpeed=1.5,this.w=i,this.h=s}return t.prototype.update=function(){this.scanlinePos+=this.scanlineSpeed,this.scanlinePos>this.scanlineEnd&&(this.scanlinePos=this.scanlineStart)},t.prototype.render=function(){this.ctx.strokeStyle="#D95970",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.arc(this.w/2,this.h/2,this.scanlinePos,0,2*Math.PI),this.ctx.stroke(),this.ctx.lineWidth=1},t}();i.Scanline=s},function(t,i){"use strict";var s=function(){function t(t,i,s){this.ctx=t,this.player=i,this.screen=s,this.barWidth=20,this.barHeight=30,this.bottomOffset=60,this.sideOffset=50,this.margin=10,this.sideMargin=40}return t.prototype.render=function(){this.drawGemBars(),this.drawHealthBar()},t.prototype.drawGemBars=function(){this.ctx.fillStyle="rgba(199, 191, 65, 1)",this.ctx.strokeStyle="rgba(199, 191, 65, 1)";for(var t=0;t<this.player.greenGoal;t++)t<this.player.green?(this.ctx.strokeRect(this.screen.width-this.sideOffset,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight),this.ctx.fillRect(this.screen.width-this.sideOffset,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight)):(this.ctx.strokeRect(this.screen.width-this.sideOffset,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight),this.ctx.fillStyle="rgba(199, 191, 65, 0.2)",this.ctx.fillRect(this.screen.width-this.sideOffset,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight));this.ctx.fillStyle="rgba(0, 90, 127, 1)",this.ctx.strokeStyle="rgba(0, 90, 127, 1)";for(var t=0;t<this.player.blueGoal;t++)t<this.player.blue?(this.ctx.strokeRect(this.screen.width-this.sideOffset-this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight),this.ctx.fillRect(this.screen.width-this.sideOffset-this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight)):(this.ctx.strokeRect(this.screen.width-this.sideOffset-this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight),this.ctx.fillStyle="rgba(0, 90, 127, 0.2)",this.ctx.fillRect(this.screen.width-this.sideOffset-this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight));this.ctx.fillStyle="rgba(255, 199, 54, 1)",this.ctx.strokeStyle="rgba(255, 199, 54, 1)";for(var t=0;t<this.player.yellowGoal;t++)t<this.player.yellow?(this.ctx.strokeRect(this.screen.width-this.sideOffset-2*this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight),this.ctx.fillRect(this.screen.width-this.sideOffset-2*this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight)):(this.ctx.strokeRect(this.screen.width-this.sideOffset-2*this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight),this.ctx.fillStyle="rgba(255, 199, 54, 0.2)",this.ctx.fillRect(this.screen.width-this.sideOffset-2*this.sideMargin,this.screen.height-this.bottomOffset-t*(this.margin+this.barHeight),this.barWidth,this.barHeight))},t.prototype.drawHealthBar=function(){this.ctx.strokeStyle="rgba(217, 89, 112, 1)",this.ctx.fillStyle="rgba(217, 89, 112, 1)";for(var t=0;t<this.player.maxHealth;t++)t<this.player.health?(this.ctx.strokeRect(this.screen.width-this.sideOffset-t*(this.margin+this.barHeight),this.bottomOffset-this.barHeight,this.barHeight,this.barWidth),this.ctx.fillRect(this.screen.width-this.sideOffset-t*(this.margin+this.barHeight),this.bottomOffset-this.barHeight,this.barHeight,this.barWidth)):(this.ctx.strokeRect(this.screen.width-this.sideOffset-t*(this.margin+this.barHeight),this.bottomOffset-this.barHeight,this.barHeight,this.barWidth),this.ctx.fillStyle="rgba(217, 89, 112, 0.1)",this.ctx.fillRect(this.screen.width-this.sideOffset-t*(this.margin+this.barHeight),this.bottomOffset-this.barHeight,this.barHeight,this.barWidth))},t}();i.Stats=s},function(t,i){"use strict";i.PATTERN={waves:[{id:0,win:{green:2,blue:1,yellow:1},enemys:[{id:0,ring:0,speed:2,delay:2e3,angle:180}],gems:[{type:"blue",id:0,ring:1,speed:1.2,delay:0,angle:90},{type:"green",id:1,ring:4,speed:3.4,delay:3200,angle:90},{type:"green",id:2,ring:2,speed:2.3,delay:1600,angle:90},{type:"yellow",id:3,ring:1,speed:2,delay:0,angle:90}]},{id:1,win:{green:4,blue:2,yellow:2},enemys:[{id:0,ring:5,speed:2,delay:1e3,angle:180},{id:0,ring:1,speed:2,delay:0,angle:180},{id:0,ring:2,speed:2,delay:0,angle:180},{id:0,ring:4,speed:2,delay:0,angle:180}],gems:[{type:"blue",id:0,ring:1,speed:1.5,delay:2e3,angle:90},{type:"blue",id:1,ring:2,speed:1.5,delay:4e3,angle:90},{type:"green",id:2,ring:2,speed:1.2,delay:0,angle:90},{type:"green",id:3,ring:3,speed:1.5,delay:0,angle:90},{type:"green",id:4,ring:4,speed:1.8,delay:0,angle:90},{type:"green",id:5,ring:5,speed:2,delay:0,angle:90},{type:"yellow",id:6,ring:0,speed:2,delay:4e3,angle:90},{type:"yellow",id:7,ring:1,speed:2.5,delay:5e3,angle:90}]}]}}]);